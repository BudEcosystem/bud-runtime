---
- name: Cleanup Kubernetes Job Resources
  hosts: localhost
  connection: local
  gather_facts: no
  collections:
      - community.kubernetes

  tasks:
      - name: Delete evaluation job
        community.kubernetes.k8s:
            state: absent
            api_version: batch/v1
            kind: Job
            name: "{{ job_name }}"
            namespace: "{{ namespace }}"
            kubeconfig: "{{ kubeconfig_path | default(omit) }}"
        ignore_errors: yes

      # Note: We no longer delete PVCs since we're using the shared bud-dev-budeval-dataset
      # Job results remain in the PVC under /results/{{ job_name }}/

      - name: Display cleanup completion
        debug:
            msg: |
                Cleanup completed for job {{ job_name }}
                Note: Results are preserved in bud-dev-budeval-dataset at /results/{{ job_name }}/
