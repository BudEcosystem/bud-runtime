name: Admin_Dashboard

on:
  push:
    branches:
      - main

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:

      - name: Install sshpass
        run: sudo apt-get install -y sshpass

      - name: update_app
        run: |
          sshpass -p ${{ secrets.SSH_PASSWORD }} ssh -o StrictHostKeyChecking=no ${{ secrets.REMOTE_USER }}@${{ secrets.REMOTE_HOST }} "\
          cd /home/budadmin/bud-serve-playground &&  \
          bash /home/budadmin/bud-serve-playground/deploy.sh" > deploy_output.log 2>&1 && cat deploy_output.log
        continue-on-error: true

      - name: Display deployment log
        run: cat deploy_output.log

      - name: Upload deployment log as an artifact
        uses: actions/upload-artifact@v4
        with:
          name: deployment-log
          path: deploy_output.log
